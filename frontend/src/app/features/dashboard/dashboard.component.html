<div class="page-header">
  <h1>Dashboard</h1>
</div>

@if (loading()) {
  <div class="loading">
    <mat-spinner></mat-spinner>
  </div>
} @else if (data()) {
  <div class="dashboard-content">
    <!-- Cards Operacionais -->
    <div class="dashboard-cards">
      <mat-card class="dashboard-card clickable" (click)="navigateToOrdens('AGUARDANDO')">
        <mat-card-content>
          <mat-icon class="card-icon aguardando">hourglass_empty</mat-icon>
          <div class="card-info">
            <span class="card-value">{{ data()!.operacional.aguardando }}</span>
            <span class="card-label">Aguardando</span>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="dashboard-card clickable" (click)="navigateToOrdens('APROVADO')">
        <mat-card-content>
          <mat-icon class="card-icon aprovado">thumb_up</mat-icon>
          <div class="card-info">
            <span class="card-value">{{ data()!.operacional.aprovado }}</span>
            <span class="card-label">Aprovadas</span>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="dashboard-card clickable" (click)="navigateToOrdens('EM_ANDAMENTO')">
        <mat-card-content>
          <mat-icon class="card-icon em-andamento">build</mat-icon>
          <div class="card-info">
            <span class="card-value">{{ data()!.operacional.emAndamento }}</span>
            <span class="card-label">Em Andamento</span>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="dashboard-card">
        <mat-card-content>
          <mat-icon class="card-icon hoje">today</mat-icon>
          <div class="card-info">
            <span class="card-value">{{ data()!.operacional.hoje }}</span>
            <span class="card-label">Agendadas Hoje</span>
          </div>
        </mat-card-content>
      </mat-card>
    </div>

    <!-- GrÃ¡ficos -->
    <div class="dashboard-charts">
      @if (isAdmin()) {
        <mat-card class="chart-card">
          <mat-card-header>
            <mat-card-title>Faturamento Mensal</mat-card-title>
          </mat-card-header>
          <mat-card-content>
            @if (faturamentoData().length > 0) {
              <ngx-charts-bar-vertical
                [results]="faturamentoData()"
                [view]="chartView!"
                [xAxis]="true"
                [yAxis]="true"
                [showXAxisLabel]="false"
                [showYAxisLabel]="false"
                [legend]="false"
                [scheme]="colorScheme"
                [gradient]="true"
                [yAxisTickFormatting]="formatCurrencyAxis"
                [tooltipDisabled]="false">
              </ngx-charts-bar-vertical>
            } @else {
              <p class="empty-chart">Sem dados de faturamento</p>
            }
          </mat-card-content>
        </mat-card>
      }

      <mat-card class="chart-card">
        <mat-card-header>
          <mat-card-title>Servicos Mais Realizados</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          @if (servicosData().length > 0) {
            <ngx-charts-pie-chart
              [results]="servicosData()"
              [view]="chartView!"
              [labels]="!isMobile"
              [doughnut]="true"
              [legend]="true"
              [legendTitle]="''"
              [legendPosition]="legendPosition"
              [scheme]="colorScheme">
            </ngx-charts-pie-chart>
          } @else {
            <p class="empty-chart">Sem dados de servicos</p>
          }
        </mat-card-content>
      </mat-card>
    </div>
  </div>
}
